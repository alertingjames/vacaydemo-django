{% extends 'motherwise/base_account.html' %}
{% block title %}VaCay Analytics{% endblock %}
{% block body %}

<br>
<br>

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<meta charset="utf-8">
<script src="https://cdn.anychart.com/js/8.0.1/anychart-core.min.js"></script>
<script src="https://cdn.anychart.com/js/8.0.1/anychart-pie.min.js"></script>

<style>

html, body{
  background: linear-gradient(0deg,rgba(0,0,0,0.8),rgba(0,0,0,0.8)), url('/static/images/accountbg.jpg') no-repeat center center fixed;
  background-size:cover;
}

table {
  width:100%;
  overflow-x:auto;
  margin:0;
}

th, td {
  border: 1px solid rgba(255,255,255,0.2);
  border-collapse: collapse;
  padding: 30px 10px 30px 10px;
  text-align: center;
  color:white;
}

th {
  font-weight: 600;
}

table tr:nth-child(even) {
  background-color: rgba(255,255,255,0.1);
}

table tr:nth-child(odd) {
  background-color: transparent;
}

#myBtn {
  display: none;
  position: fixed;
  bottom: 20%;
  right: 15px;
  z-index: 99;
  border: none;
  outline: none;
  background-color: rgba(0,0,0,0.3);
  color: white;
  cursor: pointer;
  padding: 15px;
  border-radius: 50%;
}

#myBtn:hover {
  background-color: orange;
}

h1 {
  text-align:center;
  color: #666;
  text-shadow: 1px 1px 0px #FFF;
  margin:50px 0px 0px 0px
}

.button{
    width:auto; height:auto; padding:6px 15px; margin:10px; float:left; text-align:center; border-radius:4px; font-size:16px; color:white; margin-left:5px; background-color:rgba(0,0,0,0.2);
}

::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 10px;
}

::-webkit-scrollbar-thumb {
  border-radius: 50px;
  background: #005580;
  -webkit-box-shadow: 0 0 1px rgba(255,255,255,.5);
}

/* Handle on hover */
::-webkit-scrollbar-thumb:hover {
  background: #33ccff;
}

</style>

<!--<script>-->
<!--	history.pushState(null, null, location.href);-->
<!--    history.back();-->
<!--    history.forward();-->
<!--    window.onpopstate = function () { history.go(1); };-->
<!--</script>-->

{% if note %}
<script>alert("{{note}}");</script>
{% endif %}

<meta charset="UTF-8">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../lib/w3.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


<div id="title" style="font-size:25px; font-weight:800; color: #F7D479; text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.7); text-align:center;
	position:fixed; left:50%; float:middle; transform:translate(-50%, -50%); width:350px; z-index:100; top:115px; display:none;">VaCay Analytics</div>


<div style="width:100%; height:auto; text-align:center;">
    <div style="font-size:25px; font-weight:800;
        color: #F7D479; text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.7); text-align:center; width:100%; margin-top:60px;">VaCay Analytics<br>
    </div>

    <script src="https://code.highcharts.com/highcharts.src.js"></script>

    <div style="width:100%;">

        <script>

            Highcharts.theme = {
                colors: ['#2b908f', '#90ee7e', '#f45b5b', '#7798BF', '#aaeeee', '#ff0066',
                    '#eeaaee', '#55BF3B', '#DF5353', '#7798BF', '#aaeeee'],
                chart: {
                    backgroundColor: '#00000000',
                    style: {
                        fontFamily: '\'Unica One\', sans-serif'
                    },
                    plotBorderColor: '#606063'
                },
                title: {
                    style: {
                        color: '#E0E0E3',
                        // textTransform: 'uppercase',
                        fontSize: '18px'
                    }
                },
                subtitle: {
                    style: {
                        color: '#E0E0E3',
                        // textTransform: 'uppercase'
                    }
                },
                xAxis: {
                    gridLineColor: '#707073',
                    labels: {
                        style: {
                            color: '#E0E0E3'
                        }
                    },
                    lineColor: '#707073',
                    minorGridLineColor: '#505053',
                    tickColor: '#707073',
                    title: {
                        style: {
                            color: '#A0A0A3'
                        }
                    }
                },
                yAxis: {
                    gridLineColor: '#707073',
                    labels: {
                        style: {
                            color: '#E0E0E3'
                        }
                    },
                    lineColor: '#707073',
                    minorGridLineColor: '#505053',
                    tickColor: '#707073',
                    tickWidth: 1,
                    title: {
                        style: {
                            color: '#A0A0A3'
                        }
                    }
                },
                tooltip: {
                    backgroundColor: 'rgba(0, 0, 0, 0.85)',
                    style: {
                        color: '#F0F0F0'
                    }
                },
                plotOptions: {
                    series: {
                        dataLabels: {
                            color: '#F0F0F3',
                            style: {
                                fontSize: '13px'
                            },
                            enabled: true
                        },
                        marker: {
                            lineColor: '#333'
                        }
                    },
                    boxplot: {
                        fillColor: '#505053'
                    },
                    candlestick: {
                        lineColor: 'white'
                    },
                    errorbar: {
                        color: 'white'
                    }
                },
                legend: {
                    backgroundColor: 'rgba(0, 0, 0, 0.5)',
                    itemStyle: {
                        color: '#E0E0E3'
                    },
                    itemHoverStyle: {
                        color: '#FFF'
                    },
                    itemHiddenStyle: {
                        color: '#606063'
                    },
                    title: {
                        style: {
                            color: '#C0C0C0'
                        }
                    }
                },
                credits: {
                    style: {
                        color: '#666'
                    }
                },
                labels: {
                    style: {
                        color: '#707073'
                    }
                },
                drilldown: {
                    activeAxisLabelStyle: {
                        color: '#F0F0F3'
                    },
                    activeDataLabelStyle: {
                        color: '#F0F0F3'
                    }
                },
                navigation: {
                    buttonOptions: {
                        symbolStroke: '#DDDDDD',
                        theme: {
                            fill: '#505053'
                        }
                    }
                },
                // scroll charts
                rangeSelector: {
                    buttonTheme: {
                        fill: '#505053',
                        stroke: '#000000',
                        style: {
                            color: '#CCC'
                        },
                        states: {
                            hover: {
                                fill: '#707073',
                                stroke: '#000000',
                                style: {
                                    color: 'white'
                                }
                            },
                            select: {
                                fill: '#000003',
                                stroke: '#000000',
                                style: {
                                    color: 'white'
                                }
                            }
                        }
                    },
                    inputBoxBorderColor: '#505053',
                    inputStyle: {
                        backgroundColor: '#333',
                        color: 'silver'
                    },
                    labelStyle: {
                        color: 'silver'
                    }
                },
                navigator: {
                    handles: {
                        backgroundColor: '#666',
                        borderColor: '#AAA'
                    },
                    outlineColor: '#CCC',
                    maskFill: 'rgba(255,255,255,0.1)',
                    series: {
                        color: '#7798BF',
                        lineColor: '#A6C7ED'
                    },
                    xAxis: {
                        gridLineColor: '#505053'
                    }
                },
                scrollbar: {
                    barBackgroundColor: '#808083',
                    barBorderColor: '#808083',
                    buttonArrowColor: '#CCC',
                    buttonBackgroundColor: '#606063',
                    buttonBorderColor: '#606063',
                    rifleColor: '#FFF',
                    trackBackgroundColor: '#404043',
                    trackBorderColor: '#404043'
                }
            };

            // Apply the theme
            Highcharts.setOptions(Highcharts.theme);

        </script>


        <label style="color:white; font-size:20px; font-weight:500; font-family:verdana; width:100%; text-align:center; margin:20px 0px 20px 0px;">Activated Members</label>

        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-4">
                    <div id="container2" style="height:500px;"></div><br>
                    <div id="container3" style="height:400px;"></div>
                </div>
                <div class="col-sm-4">
                    <div id="container" style="height:500px;"></div><br>
                    <div id="container4" style="height:500px;"></div>
                </div>
                <div class="col-sm-4">
                    <div id="container5" style="height:500px;"></div><br>
                    <div id="container6" style="height:500px;"></div>
                </div>
            </div>
        </div>

        <script>

            Highcharts.chart('container', {
              chart: {
                type: 'column'
              },
              title: {
                text: 'Invited Members and Activated Members by Group'
              },
              subtitle: {
                text: 'This shows how many members have been invited and how many members have been registered in the system by group.'
              },
              xAxis: {
                title: {
                  text: 'Groups'
                },
                categories: ['E81', 'E83', 'E84', 'E86', 'E87', 'S82',
                  'S85', 'S88', 'E(v)89', 'E(v)90', 'S(v)91', 'E(v)92', 'E(v)93', 'S(v)94', 'MotherWise Alumni']
              },
              yAxis: {
                title: {
                  text: 'Count of Members'
                },
                labels: {
                  formatter: function () {
                    return this.value;
                  }
                }
              },
              tooltip: {
                crosshairs: true,
                shared: true
              },
              plotOptions: {
                spline: {
                  marker: {
                    radius: 4,
                    lineColor: '#666666',
                    lineWidth: 1
                  }
                }
              },
              series: [{
                type: 'spline',
                name: 'Invited',
                data: [
                    {% for data in inviteds %}{{data}}{% if not forloop.last %}, {% endif %}{% endfor %}
                ],
                // marker: {
                //     lineWidth: 2,
                //     lineColor: Highcharts.getOptions().colors[3],
                //     fillColor: 'white'
                // }
              }, {
                name: 'Activated',
                data: [
                    {% for data in activateds %}{{data}}{% if not forloop.last %}, {% endif %}{% endfor %}
                ]
              }]
            });

            Highcharts.chart('container2', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: false,
                    type: 'pie'
                },
                title: {
                    text: 'Percentage of Activated Members(%) By Group'
                },
                subtitle: {
                    text: 'This shows in percentage how many members have been registered in the system by group.'
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                accessibility: {
                    point: {
                        valueSuffix: '%'
                    }
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true,
                            format: '<b>{point.name}</b>: {point.percentage:.1f} %'
                        }
                    }
                },
                series: [{
                    name: 'Members',
                    colorByPoint: true,
                    data: [

                        {% for data in activ_percentlist_bygroup %}

                        {
                            name: '{{data.group}}',
                            y: {{data.activ_percent}},
                            sliced: true,
                            selected: true
                        }

                        {% if not forloop.last %}, {% endif %}
                        {% endfor %}

                    ]
                }]
            });

            Highcharts.chart('container3', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: false,
                    type: 'pie',
                },
                title: {
                    text: 'Activated and Inactivated Members(%)'
                },
                subtitle: {
                    text: 'This shows in percentage how many members have been registered among the invited members in whole range.'
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                accessibility: {
                    point: {
                        valueSuffix: '%'
                    }
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true,
                            format: '<b>{point.name}</b>: {point.percentage:.1f} %'
                        }
                    }
                },
                series: [{
                    name: 'Members',
                    colorByPoint: true,
                    data: [

                        {% for data in total_activ_inactiv_percent %}

                        {
                            name: '{{data.title}}',
                            y: {{data.percvalue}},
                            sliced: true,
                            selected: true
                        }

                        {% if not forloop.last %}, {% endif %}
                        {% endfor %}

                    ]
                }]
            });

            Highcharts.chart('container4', {
              chart: {
                type: 'spline'
              },
              title: {
                text: 'Monthly Activated Members'
              },
              subtitle: {
                text: 'This shows how many members have signed up into the system monthly.'
              },
              xAxis: {
                title: {
                  text: 'Month'
                },
                categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
              },
              yAxis: {
                title: {
                  text: 'Count of Members'
                },
                labels: {
                  formatter: function () {
                    return this.value;
                  }
                }
              },
              tooltip: {
                crosshairs: true,
                shared: true
              },
              plotOptions: {
                spline: {
                  marker: {
                    radius: 4,
                    lineColor: '#666666',
                    lineWidth: 1
                  }
                }
              },
              series: [{
                name: 'Members',
                marker: {
                  symbol: 'square'
                },
                data: [
                    {% for data in monthly_activateds %}{{data}}{% if not forloop.last %}, {% endif %}{% endfor %}
                ],
                marker: {
                    lineWidth: 2,
                    lineColor: Highcharts.getOptions().colors[3],
                    fillColor: 'white'
                }
              }]
            });

            Highcharts.chart('container5', {
              chart: {
                type: 'column'
              },
              title: {
                text: 'Feed Posts by Group'
              },
              subtitle: {
                text: 'This shows how many posts have been done in the system by group.'
              },
              xAxis: {
                title: {
                  text: 'Groups'
                },
                categories: ['E81', 'E83', 'E84', 'E86', 'E87', 'S82',
                  'S85', 'S88', 'E(v)89', 'E(v)90', 'S(v)91', 'E(v)92', 'E(v)93', 'S(v)94', 'MotherWise Alumni']
              },
              yAxis: {
                title: {
                  text: 'Count of Posts'
                },
                labels: {
                  formatter: function () {
                    return this.value;
                  }
                }
              },
              tooltip: {
                crosshairs: true,
                shared: true
              },
              plotOptions: {
                spline: {
                  marker: {
                    radius: 4,
                    lineColor: '#666666',
                    lineWidth: 1
                  }
                }
              },
              series: [{
                name: 'Posts',
                data: [
                    {% for data in group_posts %}{{data}}{% if not forloop.last %}, {% endif %}{% endfor %}
                ]
              }]
            });

            Highcharts.chart('container6', {
              chart: {
                type: 'column',
                inverted: true
              },
              title: {
                text: 'Monthly Feed Posts'
              },
              subtitle: {
                text: 'This shows how many posts they have done monthly.'
              },
              xAxis: {
                title: {
                  text: 'Month'
                },
                categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
              },
              yAxis: {
                title: {
                  text: 'Count of Posts'
                },
                labels: {
                  formatter: function () {
                    return this.value;
                  }
                }
              },
              tooltip: {
                crosshairs: true,
                shared: true
              },
              plotOptions: {
                spline: {
                  marker: {
                    radius: 4,
                    lineColor: '#666666',
                    lineWidth: 1
                  }
                }
              },
              series: [{
                name: 'Posts',
                marker: {
                  symbol: 'diamond'
                },
                data: [
                    {% for data in monthly_posts %}{{data}}{% if not forloop.last %}, {% endif %}{% endfor %}
                ],
                colorByPoint: true
              }]
            });

        </script>

    </div>

    <br>

    <div style="width:100%; overflow-x:auto;">
        <div id="container7" style="height:500px; width:{{cityActivsChartWidth}}px; min-width:100%;"></div>
    </div>

    <script>

        Highcharts.chart('container7', {
            chart: {
                type: 'column',
            },
            title: {
                text: 'Activated Members by City'
            },
            subtitle: {
                text: 'This shows how many members have been registered in the system by city.'
            },
            xAxis: {
                title: {
                  text: 'City'
                },
                categories: [{% for data in city_activateds %}'{{data.city}}'{% if not forloop.last %}, {% endif %}{% endfor %}]
            },
            yAxis: {
                title: {
                  text: 'Count of Members'
                },
                labels: {
                  formatter: function () {
                    return this.value;
                  }
                }
            },
            tooltip: {
                crosshairs: true,
                shared: true
            },
            plotOptions: {
                spline: {
                  marker: {
                    radius: 4,
                    lineColor: '#666666',
                    lineWidth: 1
                  }
                }
            },
            series: [{
                colorByPoint: true,
                name: 'Members',
                marker: {
                  symbol: 'square'
                },
                data: [
                    {% for data in city_activateds %}{{data.activsval}}{% if not forloop.last %}, {% endif %}{% endfor %}
                ]

            }]
        });

    </script>


    <div style="width:100%; margin-left:50px;">

        <div class="container-fluid">
            {% for data in city_activateds %}
            <label style="color:white; font-size:16px; width:150px; text-align:left; float:left;">{{forloop.counter}}. {{data.city}} :</label>
            <div class="row">
                {% for member in data.activmembers %}
                <div class="col-sm-1" style="text-align:left;">
                    <div style="display:inline-block; width:100%; min-width:250px;">
                        <img src="{% if member.photo_url %}{{member.photo_url}}{% else %}/static/images/ic_profile.png{% endif %}"
                            style="width:40px; height:40px; border-radius:50%; object-fit:cover;">
                        <label style="color:rgba(255,255,255,0.6); font-size:12px; margin-left:10px;">{{member.name}}</label>
                    </div>
                </div>
                {% endfor %}
            </div>
            <br>
            {% endfor %}
        </div>

    </div>


    <!--<div id="container6" style="height:400px;"></div>-->

    <!--<script>-->

    <!--    Highcharts.chart('container6', {-->
    <!--        chart: {-->
    <!--            plotBackgroundColor: null,-->
    <!--            plotBorderWidth: 0,-->
    <!--            plotShadow: false-->
    <!--        },-->
    <!--        title: {-->
    <!--            text: 'Activated<br>members',-->
    <!--            align: 'center',-->
    <!--            verticalAlign: 'middle',-->
    <!--            y: 60-->
    <!--        },-->
    <!--        tooltip: {-->
    <!--            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'-->
    <!--        },-->
    <!--        accessibility: {-->
    <!--            point: {-->
    <!--                valueSuffix: '%'-->
    <!--            }-->
    <!--        },-->
    <!--        plotOptions: {-->
    <!--            pie: {-->
    <!--                dataLabels: {-->
    <!--                    enabled: true,-->
    <!--                    distance: -50,-->
    <!--                    style: {-->
    <!--                        fontWeight: 'bold',-->
    <!--                        color: 'white'-->
    <!--                    }-->
    <!--                },-->
    <!--                startAngle: -90,-->
    <!--                endAngle: 90,-->
    <!--                center: ['50%', '75%'],-->
    <!--                size: '110%'-->
    <!--            }-->
    <!--        },-->
    <!--        series: [{-->
    <!--            type: 'pie',-->
    <!--            name: 'Members',-->
    <!--            innerSize: '50%',-->
    <!--            data: [-->
    <!--                {% for data in total_activ_inactiv_percent %}-->

    <!--                    ['{{data.title}}', {{data.percvalue}}]-->

    <!--                    {% if not forloop.last %}, {% endif %}-->
    <!--                {% endfor %}-->
    <!--            ]-->
    <!--        }]-->
    <!--    });-->

    <!--</script>-->


    <!--<label style="color:white; font-size:20px; font-weight:500; font-family:verdana; width:100%; text-align:center; margin:30px 0px 15px 0px;">Run Detail</label>-->



    <br>
    <br>

</div>

<meta charset="UTF-8">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">

<button onclick="topFunction()" id="myBtn" title="Go to top"><i class="glyphicon glyphicon-menu-up" style="color:white; font-size:14px;"></i></button>

<script>
// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
    if (document.body.scrollTop > 80 || document.documentElement.scrollTop > 80) {
        document.getElementById("myBtn").style.display = "block";
        document.getElementById("title").style.display = "block";
    } else {
        document.getElementById("myBtn").style.display = "none";
        document.getElementById("title").style.display = "none";
    }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
}

function getCookie(name) {
    console.log('getCookie');
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                    var cookie = jQuery.trim(cookies[i]);
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) == (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                    }
            }
    }
    console.log('cookie:' + cookieValue);
    return cookieValue;
}

function post(path, params, method) {
   method = method || "post"; // Set method to post by default if not specified.

   // The rest of this code assumes you are not using a library.
   // It can be made less wordy if you use one.
   var form = document.createElement("form");
   form.setAttribute("method", method);
   form.setAttribute("action", path);

   for(var key in params) {
      if(params.hasOwnProperty(key)) {
          var hiddenField = document.createElement("input");
          hiddenField.setAttribute("type", "hidden");
          hiddenField.setAttribute("name", key);
          hiddenField.setAttribute("value", params[key]);

          form.appendChild(hiddenField);
      }
   }

   var hiddenField1 = document.createElement("input");
   hiddenField1.setAttribute("type", "hidden");
   hiddenField1.setAttribute("name", 'csrfmiddlewaretoken');
   hiddenField1.setAttribute("value", getCookie('csrftoken'));
   form.appendChild(hiddenField1);

   document.body.appendChild(form);
   form.submit();
}

</script>


{% endblock %}
































































